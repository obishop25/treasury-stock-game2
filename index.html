<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Treasury Stock Accounting Practice - v5</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Simple icon components
        const TrendingUp = () => <span style={{fontSize: '1em'}}>ðŸ“ˆ</span>;
        const TrendingDown = () => <span style={{fontSize: '1em'}}>ðŸ“‰</span>;
        const RefreshCw = () => <span style={{fontSize: '1em'}}>ðŸ”„</span>;

        function TreasuryStockGame() {
            const [gameState, setGameState] = useState({
                cash: 100000,
                commonStock: 50000,
                paidInCapital: 20000,
                paidInCapitalTS: 0,
                retainedEarnings: 30000,
                treasuryStock: 0,
                treasuryShares: 0,
                sharesOutstanding: 10000,
                purchasePrice: 0,
                transactions: [],
                transactionNumber: 0,
                currentScenario: null,
                // T-Account transaction details
                cashTransactions: [],
                commonStockTransactions: [],
                paidInCapitalTransactions: [],
                retainedEarningsTransactions: [],
                treasuryStockTransactions: [],
                paidInCapitalTSTransactions: []
            });

            const [actionType, setActionType] = useState('buy');
            const [shares, setShares] = useState(100);
            const [pricePerShare, setPricePerShare] = useState(10);
            const [allJournalEntries, setAllJournalEntries] = useState([]);

            const resetGame = () => {
                setGameState({
                    cash: 100000,
                    commonStock: 50000,
                    paidInCapital: 20000,
                    paidInCapitalTS: 0,
                    retainedEarnings: 30000,
                    treasuryStock: 0,
                    treasuryShares: 0,
                    sharesOutstanding: 10000,
                    purchasePrice: 0,
                    transactions: [],
                    transactionNumber: 0,
                    currentScenario: null,
                    cashTransactions: [],
                    commonStockTransactions: [],
                    paidInCapitalTransactions: [],
                    retainedEarningsTransactions: [],
                    treasuryStockTransactions: [],
                    paidInCapitalTSTransactions: []
                });
                setAllJournalEntries([]);
                // Reset transaction form to defaults
                setActionType('buy');
                setShares(100);
                setPricePerShare(10);
            };

            const buyTreasuryStock = () => {
                const cost = shares * pricePerShare;
                
                if (cost > gameState.cash) {
                    alert("Not enough cash!");
                    return;
                }

                const nextTransactionNum = gameState.transactionNumber + 1;

                const newState = {
                    ...gameState,
                    cash: gameState.cash - cost,
                    treasuryStock: gameState.treasuryStock + cost,
                    treasuryShares: gameState.treasuryShares + shares,
                    purchasePrice: pricePerShare,
                    transactionNumber: nextTransactionNum,
                    transactions: [...gameState.transactions, {
                        number: nextTransactionNum,
                        type: 'Purchase',
                        shares: shares,
                        price: pricePerShare,
                        total: cost
                    }],
                    cashTransactions: [...gameState.cashTransactions, { transNum: nextTransactionNum, type: 'credit', amount: cost }],
                    treasuryStockTransactions: [...gameState.treasuryStockTransactions, { transNum: nextTransactionNum, type: 'debit', amount: cost }]
                };

                const entry = {
                    transactionNumber: nextTransactionNum,
                    debit: [{ account: 'Treasury Stock', amount: cost }],
                    credit: [{ account: 'Cash', amount: cost }],
                    description: `Purchased ${shares} shares at $${pricePerShare}/share`
                };

                setAllJournalEntries([...allJournalEntries, entry]);
                setGameState(newState);
            };

            const sellTreasuryStock = () => {
                if (gameState.treasuryShares === 0) {
                    alert("No treasury stock to sell!");
                    return;
                }

                if (shares > gameState.treasuryShares) {
                    alert(`Insufficient treasury shares. You have ${gameState.treasuryShares} shares but are trying to sell ${shares} shares.`);
                    return;
                }

                const proceeds = shares * pricePerShare;
                const costBasis = shares * gameState.purchasePrice;
                const difference = proceeds - costBasis;

                const nextTransactionNum = gameState.transactionNumber + 1;

                let newState = { ...gameState };
                let entry = {
                    transactionNumber: nextTransactionNum,
                    debit: [],
                    credit: [],
                    description: ''
                };

                // Selling at cost
                if (difference === 0) {
                    newState = {
                        ...gameState,
                        cash: gameState.cash + proceeds,
                        treasuryStock: gameState.treasuryStock - costBasis,
                        treasuryShares: gameState.treasuryShares - shares,
                        transactionNumber: nextTransactionNum,
                        currentScenario: 'at-cost',
                        transactions: [...gameState.transactions, {
                            number: nextTransactionNum,
                            type: 'Sale at Cost',
                            shares: shares,
                            price: pricePerShare,
                            total: proceeds
                        }],
                        cashTransactions: [...gameState.cashTransactions, { transNum: nextTransactionNum, type: 'debit', amount: proceeds }],
                        treasuryStockTransactions: [...gameState.treasuryStockTransactions, { transNum: nextTransactionNum, type: 'credit', amount: costBasis }]
                    };

                    entry = {
                        transactionNumber: nextTransactionNum,
                        debit: [{ account: 'Cash', amount: proceeds }],
                        credit: [{ account: 'Treasury Stock', amount: costBasis }],
                        description: `Sold ${shares} shares at cost ($${pricePerShare}/share)`,
                        note: 'âœ“ No gain or loss - sold at original purchase price!'
                    };
                }
                // Selling above cost
                else if (difference > 0) {
                    newState = {
                        ...gameState,
                        cash: gameState.cash + proceeds,
                        treasuryStock: gameState.treasuryStock - costBasis,
                        paidInCapital: gameState.paidInCapital + difference,
                        paidInCapitalTS: gameState.paidInCapitalTS + difference,
                        treasuryShares: gameState.treasuryShares - shares,
                        transactionNumber: nextTransactionNum,
                        currentScenario: 'above-cost',
                        transactions: [...gameState.transactions, {
                            number: nextTransactionNum,
                            type: 'Sale Above Cost',
                            shares: shares,
                            price: pricePerShare,
                            total: proceeds,
                            gain: difference
                        }],
                        cashTransactions: [...gameState.cashTransactions, { transNum: nextTransactionNum, type: 'debit', amount: proceeds }],
                        treasuryStockTransactions: [...gameState.treasuryStockTransactions, { transNum: nextTransactionNum, type: 'credit', amount: costBasis }],
                        paidInCapitalTSTransactions: [...gameState.paidInCapitalTSTransactions, { transNum: nextTransactionNum, type: 'credit', amount: difference }]
                    };

                    entry = {
                        transactionNumber: nextTransactionNum,
                        debit: [{ account: 'Cash', amount: proceeds }],
                        credit: [
                            { account: 'Treasury Stock', amount: costBasis },
                            { account: 'Paid-in Capital - Treasury Stock', amount: difference }
                        ],
                        description: `Sold ${shares} shares above cost ($${pricePerShare}/share vs $${gameState.purchasePrice}/share cost)`,
                        note: `âœ“ Excess of $${difference.toLocaleString()} goes to Paid-in Capital, NOT income!`
                    };
                }
                // Selling below cost
                else {
                    const loss = Math.abs(difference);
                    let fromPaidInTS = Math.min(loss, gameState.paidInCapitalTS);
                    let fromRetained = loss - fromPaidInTS;

                    const newCashTransactions = [...gameState.cashTransactions, { transNum: nextTransactionNum, type: 'debit', amount: proceeds }];
                    const newTreasuryStockTransactions = [...gameState.treasuryStockTransactions, { transNum: nextTransactionNum, type: 'credit', amount: costBasis }];
                    const newPaidInCapitalTSTransactions = fromPaidInTS > 0 
                        ? [...gameState.paidInCapitalTSTransactions, { transNum: nextTransactionNum, type: 'debit', amount: fromPaidInTS }]
                        : gameState.paidInCapitalTSTransactions;
                    const newRetainedEarningsTransactions = fromRetained > 0
                        ? [...gameState.retainedEarningsTransactions, { transNum: nextTransactionNum, type: 'debit', amount: fromRetained }]
                        : gameState.retainedEarningsTransactions;

                    newState = {
                        ...gameState,
                        cash: gameState.cash + proceeds,
                        treasuryStock: gameState.treasuryStock - costBasis,
                        paidInCapital: gameState.paidInCapital - fromPaidInTS,
                        paidInCapitalTS: gameState.paidInCapitalTS - fromPaidInTS,
                        retainedEarnings: gameState.retainedEarnings - fromRetained,
                        treasuryShares: gameState.treasuryShares - shares,
                        transactionNumber: nextTransactionNum,
                        currentScenario: 'below-cost',
                        transactions: [...gameState.transactions, {
                            number: nextTransactionNum,
                            type: 'Sale Below Cost',
                            shares: shares,
                            price: pricePerShare,
                            total: proceeds,
                            loss: loss
                        }],
                        cashTransactions: newCashTransactions,
                        treasuryStockTransactions: newTreasuryStockTransactions,
                        paidInCapitalTSTransactions: newPaidInCapitalTSTransactions,
                        retainedEarningsTransactions: newRetainedEarningsTransactions
                    };

                    entry = {
                        transactionNumber: nextTransactionNum,
                        debit: [
                            { account: 'Cash', amount: proceeds },
                            ...(fromPaidInTS > 0 ? [{ account: 'Paid-in Capital - Treasury Stock', amount: fromPaidInTS }] : []),
                            ...(fromRetained > 0 ? [{ account: 'Retained Earnings', amount: fromRetained }] : [])
                        ],
                        credit: [{ account: 'Treasury Stock', amount: costBasis }],
                        description: `Sold ${shares} shares below cost ($${pricePerShare}/share vs $${gameState.purchasePrice}/share cost)`,
                        note: `âœ“ Deficit of $${loss.toLocaleString()} reduces equity, NOT an expense!${fromPaidInTS > 0 ? ` ($${fromPaidInTS.toLocaleString()} from Paid-in Capital - TS)` : ''}${fromRetained > 0 ? ` ($${fromRetained.toLocaleString()} from Retained Earnings)` : ''}`
                    };
                }

                setAllJournalEntries([...allJournalEntries, entry]);
                setGameState(newState);
            };

            const executeTransaction = () => {
                if (actionType === 'buy') {
                    buyTreasuryStock();
                } else {
                    sellTreasuryStock();
                }
            };

            const totalEquity = gameState.commonStock + gameState.paidInCapital + 
                                gameState.retainedEarnings - gameState.treasuryStock;

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-lg shadow-2xl p-8 mb-6">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-4xl font-bold text-indigo-900 mb-2">
                                        Treasury Stock Accounting Practice
                                    </h1>
                                    <p className="text-gray-600">Practice treasury stock transactions and see the accounting entries in real-time.</p>
                                </div>
                                <div className="text-right">
                                    <button
                                        onClick={resetGame}
                                        className="flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                                    >
                                        <RefreshCw />
                                        Reset
                                    </button>
                                </div>
                            </div>

                            {/* Balance Sheet */}
                            <div className="grid grid-cols-2 gap-6 mb-8">
                                <div className="bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg border-2 border-green-200">
                                    <h2 className="text-2xl font-bold text-green-800 mb-4">Assets</h2>
                                    <div className="space-y-2 text-lg">
                                        <div className="flex justify-between">
                                            <span>Cash:</span>
                                            <span className="font-semibold">${gameState.cash.toLocaleString()}</span>
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border-2 border-blue-200">
                                    <h2 className="text-2xl font-bold text-blue-800 mb-4">Stockholders' Equity</h2>
                                    <div className="space-y-2 text-lg">
                                        <div className="flex justify-between">
                                            <span>Common Stock:</span>
                                            <span className="font-semibold">${gameState.commonStock.toLocaleString()}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span>Paid-in Capital:</span>
                                            <span className="font-semibold">${gameState.paidInCapital.toLocaleString()}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span>Retained Earnings:</span>
                                            <span className="font-semibold">${gameState.retainedEarnings.toLocaleString()}</span>
                                        </div>
                                        <div className="flex justify-between text-red-600">
                                            <span>Less: Treasury Stock ({gameState.treasuryShares} shares):</span>
                                            <span className="font-semibold">(${gameState.treasuryStock.toLocaleString()})</span>
                                        </div>
                                        <div className="border-t-2 border-indigo-300 pt-2 mt-2">
                                            <div className="flex justify-between font-bold text-xl">
                                                <span>Total Equity:</span>
                                                <span>${totalEquity.toLocaleString()}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* SECTION 1: Transaction History - MOVED TO TOP */}
                            {gameState.transactions.length > 0 && (
                                <div className="bg-gray-50 p-6 rounded-lg border-2 border-gray-200 mb-6">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Transaction History</h2>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-sm">
                                            <thead>
                                                <tr className="border-b-2 border-gray-300">
                                                    <th className="text-left py-2">Trans #</th>
                                                    <th className="text-left py-2">Type</th>
                                                    <th className="text-right py-2">Shares</th>
                                                    <th className="text-right py-2">Price/Share</th>
                                                    <th className="text-right py-2">Total</th>
                                                    <th className="text-right py-2">Gain/Loss</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {gameState.transactions.map((trans) => (
                                                    <tr key={trans.number} className="border-b border-gray-200">
                                                        <td className="py-2 font-bold">#{trans.number}</td>
                                                        <td className="py-2">{trans.type}</td>
                                                        <td className="text-right">{trans.shares}</td>
                                                        <td className="text-right">${trans.price}</td>
                                                        <td className="text-right">${trans.total.toLocaleString()}</td>
                                                        <td className="text-right">
                                                            {trans.gain && <span className="text-green-600">+${trans.gain.toLocaleString()}</span>}
                                                            {trans.loss && <span className="text-red-600">-${trans.loss.toLocaleString()}</span>}
                                                            {!trans.gain && !trans.loss && <span className="text-gray-400">-</span>}
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}

                            {/* SECTION 2: Execute Transaction */}
                            <div className="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border-2 border-purple-200 mb-6">
                                <h2 className="text-2xl font-bold text-purple-800 mb-4">Execute Transaction</h2>
                                
                                <div className="grid grid-cols-4 gap-4 mb-4">
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">Action</label>
                                        <select
                                            value={actionType}
                                            onChange={(e) => setActionType(e.target.value)}
                                            className="w-full p-3 border-2 border-purple-300 rounded-lg focus:border-purple-500 focus:outline-none"
                                        >
                                            <option value="buy">Buy Treasury Stock</option>
                                            <option value="sell">Sell Treasury Stock</option>
                                        </select>
                                    </div>

                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">Number of Shares</label>
                                        <input
                                            type="number"
                                            value={shares}
                                            onChange={(e) => setShares(parseInt(e.target.value) || 0)}
                                            className="w-full p-3 border-2 border-purple-300 rounded-lg focus:border-purple-500 focus:outline-none"
                                            min="1"
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-2">Price per Share</label>
                                        <input
                                            type="number"
                                            value={pricePerShare}
                                            onChange={(e) => setPricePerShare(parseInt(e.target.value) || 0)}
                                            className="w-full p-3 border-2 border-purple-300 rounded-lg focus:border-purple-500 focus:outline-none"
                                            min="1"
                                        />
                                    </div>

                                    <div className="flex items-end">
                                        <button
                                            onClick={executeTransaction}
                                            className="w-full p-3 bg-purple-600 text-white font-bold rounded-lg hover:bg-purple-700 transition-colors"
                                        >
                                            Execute
                                        </button>
                                    </div>
                                </div>

                                {gameState.treasuryShares > 0 && actionType === 'sell' && (
                                    <div className="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-4">
                                        <p className="text-sm font-semibold text-yellow-800">
                                            ðŸ’¡ Your treasury stock cost basis: ${gameState.purchasePrice}/share
                                            {pricePerShare > gameState.purchasePrice && (
                                                <span className="text-green-600 ml-2">
                                                    <TrendingUp /> Selling ABOVE cost!
                                                </span>
                                            )}
                                            {pricePerShare < gameState.purchasePrice && (
                                                <span className="text-red-600 ml-2">
                                                    <TrendingDown /> Selling BELOW cost!
                                                </span>
                                            )}
                                            {pricePerShare === gameState.purchasePrice && (
                                                <span className="text-blue-600 ml-2">
                                                    âœ“ Selling AT cost!
                                                </span>
                                            )}
                                        </p>
                                    </div>
                                )}
                            </div>

                            {/* SECTION 3: T-Accounts with Transaction Numbers Only */}
                            <div className="bg-gradient-to-r from-slate-50 to-gray-50 p-6 rounded-lg border-2 border-slate-300 mb-8">
                                <h2 className="text-2xl font-bold text-slate-800 mb-6">T-Accounts</h2>
                                <div className="grid grid-cols-3 gap-4">
                                    {/* Cash T-Account */}
                                    <div className="bg-white p-4 rounded-lg border-2 border-slate-300 shadow-sm">
                                        <h3 className="text-center font-bold text-slate-700 mb-3 pb-2 border-b-2 border-slate-400">Cash</h3>
                                        <div className="grid grid-cols-2 gap-2 text-xs">
                                            <div className="border-r-2 border-slate-300 pr-2">
                                                <div className="font-semibold text-gray-600 mb-1">Debit</div>
                                                <div className="mb-2 text-blue-600 font-semibold">Beg: $100,000</div>
                                                {gameState.cashTransactions.filter(t => t.type === 'debit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                                <div className="border-t border-slate-300 mt-2 pt-1 font-bold text-green-700">
                                                    End: ${gameState.cash.toLocaleString()}
                                                </div>
                                            </div>
                                            <div className="pl-2">
                                                <div className="font-semibold text-gray-600 mb-1">Credit</div>
                                                <div className="mb-2">&nbsp;</div>
                                                {gameState.cashTransactions.filter(t => t.type === 'credit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Common Stock T-Account */}
                                    <div className="bg-white p-4 rounded-lg border-2 border-slate-300 shadow-sm">
                                        <h3 className="text-center font-bold text-slate-700 mb-3 pb-2 border-b-2 border-slate-400">Common Stock</h3>
                                        <div className="grid grid-cols-2 gap-2 text-xs">
                                            <div className="border-r-2 border-slate-300 pr-2">
                                                <div className="font-semibold text-gray-600 mb-1">Debit</div>
                                                <div className="mb-2">&nbsp;</div>
                                                {gameState.commonStockTransactions.filter(t => t.type === 'debit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                            </div>
                                            <div className="pl-2">
                                                <div className="font-semibold text-gray-600 mb-1">Credit</div>
                                                <div className="mb-2 text-blue-600 font-semibold">Beg: $50,000</div>
                                                {gameState.commonStockTransactions.filter(t => t.type === 'credit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                                <div className="border-t border-slate-300 mt-2 pt-1 font-bold text-green-700">
                                                    End: ${gameState.commonStock.toLocaleString()}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Paid-in Capital T-Account */}
                                    <div className="bg-white p-4 rounded-lg border-2 border-slate-300 shadow-sm">
                                        <h3 className="text-center font-bold text-slate-700 mb-3 pb-2 border-b-2 border-slate-400">Paid-in Capital</h3>
                                        <div className="grid grid-cols-2 gap-2 text-xs">
                                            <div className="border-r-2 border-slate-300 pr-2">
                                                <div className="font-semibold text-gray-600 mb-1">Debit</div>
                                                <div className="mb-2">&nbsp;</div>
                                                {gameState.paidInCapitalTransactions.filter(t => t.type === 'debit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                            </div>
                                            <div className="pl-2">
                                                <div className="font-semibold text-gray-600 mb-1">Credit</div>
                                                <div className="mb-2 text-blue-600 font-semibold">Beg: $20,000</div>
                                                {gameState.paidInCapitalTransactions.filter(t => t.type === 'credit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                                <div className="border-t border-slate-300 mt-2 pt-1 font-bold text-green-700">
                                                    End: ${gameState.paidInCapital.toLocaleString()}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Retained Earnings T-Account */}
                                    <div className="bg-white p-4 rounded-lg border-2 border-slate-300 shadow-sm">
                                        <h3 className="text-center font-bold text-slate-700 mb-3 pb-2 border-b-2 border-slate-400">Retained Earnings</h3>
                                        <div className="grid grid-cols-2 gap-2 text-xs">
                                            <div className="border-r-2 border-slate-300 pr-2">
                                                <div className="font-semibold text-gray-600 mb-1">Debit</div>
                                                <div className="mb-2">&nbsp;</div>
                                                {gameState.retainedEarningsTransactions.filter(t => t.type === 'debit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                            </div>
                                            <div className="pl-2">
                                                <div className="font-semibold text-gray-600 mb-1">Credit</div>
                                                <div className="mb-2 text-blue-600 font-semibold">Beg: $30,000</div>
                                                {gameState.retainedEarningsTransactions.filter(t => t.type === 'credit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                                <div className="border-t border-slate-300 mt-2 pt-1 font-bold text-green-700">
                                                    End: ${gameState.retainedEarnings.toLocaleString()}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Treasury Stock T-Account */}
                                    <div className="bg-white p-4 rounded-lg border-2 border-slate-300 shadow-sm">
                                        <h3 className="text-center font-bold text-slate-700 mb-3 pb-2 border-b-2 border-slate-400">Treasury Stock</h3>
                                        <div className="grid grid-cols-2 gap-2 text-xs">
                                            <div className="border-r-2 border-slate-300 pr-2">
                                                <div className="font-semibold text-gray-600 mb-1">Debit</div>
                                                <div className="mb-2 text-blue-600 font-semibold">Beg: $0</div>
                                                {gameState.treasuryStockTransactions.filter(t => t.type === 'debit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                                <div className="border-t border-slate-300 mt-2 pt-1 font-bold text-red-700">
                                                    End: ${gameState.treasuryStock.toLocaleString()}
                                                </div>
                                            </div>
                                            <div className="pl-2">
                                                <div className="font-semibold text-gray-600 mb-1">Credit</div>
                                                <div className="mb-2">&nbsp;</div>
                                                {gameState.treasuryStockTransactions.filter(t => t.type === 'credit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    </div>

                                    {/* Paid-in Capital - Treasury Stock T-Account (ALWAYS SHOW) */}
                                    <div className="bg-white p-4 rounded-lg border-2 border-amber-300 shadow-sm">
                                        <h3 className="text-center font-bold text-slate-700 mb-3 pb-2 border-b-2 border-amber-400 text-xs">Paid-in Capital - TS</h3>
                                        <div className="grid grid-cols-2 gap-2 text-xs">
                                            <div className="border-r-2 border-slate-300 pr-2">
                                                <div className="font-semibold text-gray-600 mb-1">Debit</div>
                                                <div className="mb-2 text-blue-600 font-semibold">Beg: $0</div>
                                                {gameState.paidInCapitalTSTransactions.filter(t => t.type === 'debit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                            </div>
                                            <div className="pl-2">
                                                <div className="font-semibold text-gray-600 mb-1">Credit</div>
                                                <div className="mb-2">&nbsp;</div>
                                                {gameState.paidInCapitalTSTransactions.filter(t => t.type === 'credit').map((trans, idx) => (
                                                    <div key={idx} className="mb-1">
                                                        #{trans.transNum} ${trans.amount.toLocaleString()}
                                                    </div>
                                                ))}
                                                <div className="border-t border-slate-300 mt-2 pt-1 font-bold text-green-700">
                                                    End: ${gameState.paidInCapitalTS.toLocaleString()}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p className="text-xs text-gray-600 mt-4 italic">
                                    ðŸ’¡ T-accounts show transaction numbers for easy reference to the transaction history and journal entries.
                                </p>
                            </div>

                            {/* SECTION 4: All Journal Entries Display - CUMULATIVE */}
                            {allJournalEntries.length > 0 && (
                                <div className="bg-gradient-to-r from-amber-50 to-orange-50 p-6 rounded-lg border-2 border-amber-300 mb-6">
                                    <h2 className="text-2xl font-bold text-amber-800 mb-4">ðŸ“– Journal Entries</h2>
                                    
                                    {allJournalEntries.map((entry, entryIndex) => (
                                        <div key={entry.transactionNumber}>
                                            <h3 className="text-lg font-bold text-amber-700 mb-2">Transaction #{entry.transactionNumber}</h3>
                                            <p className="text-gray-700 mb-3 italic">{entry.description}</p>
                                            
                                            <div className="bg-white p-4 rounded-lg shadow-inner font-mono text-sm mb-4">
                                                <table className="w-full">
                                                    <thead>
                                                        <tr className="border-b-2 border-gray-300">
                                                            <th className="text-left py-2">Account</th>
                                                            <th className="text-right py-2">Debit</th>
                                                            <th className="text-right py-2">Credit</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {entry.debit.map((item, idx) => (
                                                            <tr key={`debit-${idx}`}>
                                                                <td className="py-1">{item.account}</td>
                                                                <td className="text-right">${item.amount.toLocaleString()}</td>
                                                                <td></td>
                                                            </tr>
                                                        ))}
                                                        {entry.credit.map((item, idx) => (
                                                            <tr key={`credit-${idx}`}>
                                                                <td className="py-1 pl-8">{item.account}</td>
                                                                <td></td>
                                                                <td className="text-right">${item.amount.toLocaleString()}</td>
                                                            </tr>
                                                        ))}
                                                    </tbody>
                                                </table>
                                            </div>

                                            {entry.note && (
                                                <div className="bg-green-100 border-l-4 border-green-500 p-4 rounded mb-4">
                                                    <p className="font-semibold text-green-800">{entry.note}</p>
                                                </div>
                                            )}

                                            {/* Dividing line between entries (except after last entry) */}
                                            {entryIndex < allJournalEntries.length - 1 && (
                                                <hr className="my-6 border-t-2 border-amber-200" />
                                            )}
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* Instructions */}
                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <h2 className="text-2xl font-bold text-gray-800 mb-4">ðŸ“š Instructions</h2>
                            <div className="grid grid-cols-3 gap-4 text-sm">
                                <div className="bg-blue-50 p-4 rounded-lg">
                                    <h3 className="font-bold text-blue-800 mb-2">1. Buy Treasury Stock</h3>
                                    <p>Purchase shares from the market. Cash decreases, Treasury Stock (contra-equity) increases.</p>
                                </div>
                                <div className="bg-green-50 p-4 rounded-lg">
                                    <h3 className="font-bold text-green-800 mb-2">2. Sell at Different Prices</h3>
                                    <p>Try selling at cost, above cost, and below cost to see different accounting treatments!</p>
                                </div>
                                <div className="bg-purple-50 p-4 rounded-lg">
                                    <h3 className="font-bold text-purple-800 mb-2">3. Learn the Rules</h3>
                                    <p>Remember: Companies can't report gains or losses on their own stock. Everything affects equity!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TreasuryStockGame />);
    </script>
</body>
</html>
